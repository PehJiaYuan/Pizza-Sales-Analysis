--1. Total Revenue
SELECT CAST(SUM(total_price) AS DECIMAL(10,2))
AS total_revenue
FROM pizza_sales;

--2. Average Order Value
SELECT CAST(CAST(SUM(total_price) AS DECIMAL(10,2)) / 
CAST(COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS DECIMAL(10,2))
AS avg_order_value
FROM pizza_sales

--3. Total Pizzas Sold 
SELECT SUM(quantity) 
AS total_pizza_sold
FROM pizza_sales;

--4. Total Orders 
SELECT COUNT(DISTINCT order_id) 
AS total_orders
FROM pizza_sales;

--5. Average Pizzas Per Order
SELECT CAST (CAST(SUM(quantity) AS DECIMAL(10,2)) / 
CAST (COUNT(DISTINCT order_id) AS DECIMAL(10,2)) AS DECIMAL(10,2)) 
AS avg_pizzas_per_order
FROM pizza_sales;

-------------------------------------------------------------------------------------------------
--To visualise various aspect of pizza sales data to gain insights and understand key trends
-------------------------------------------------------------------------------------------------

--1. Monthly trend for total orders
SELECT DATENAME(MONTH, order_date) AS month_name, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DATENAME(MONTH, order_date);

--2. Daily trend for total orders 
SELECT DATENAME(DW, order_date) AS order_day, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY DATENAME(DW,order_date);

--3. Hourly trend for total orders 
SELECT DATEPART(HOUR, order_time) AS order_Hours, COUNT (DISTINCT order_id) AS total_orders 
FROM pizza_sales
GROUP BY DATEPART(HOUR, order_time)
ORDER BY DATEPART(HOUR, order_time);

--4. Percentage of sales by Pizza Category 
SELECT pizza_category, CAST(SUM(total_price) AS DECIMAL(10,2)) AS total_sales, CAST(SUM(total_price)*100/
(SELECT SUM(total_price) FROM pizza_sales) AS DECIMAL(10,2)) AS percentage_total_sales
FROM pizza_sales 
GROUP BY pizza_category;

--5. Percentage of sales based on pizza size 
SELECT pizza_size, CAST(SUM(total_price) AS DECIMAL(10,2))AS total_sales, CAST(SUM(total_price)*100/
(SELECT SUM(total_price) FROM pizza_sales) AS DECIMAL(10,2))AS percentage_total_sales
FROM pizza_sales
GROUP BY pizza_size
ORDER BY percentage_total_sales DESC;

--6. Total pizza sold by pizza Category
SELECT pizza_category, sum(quantity) as total_pizzas_sold 
FROM pizza_sales
GROUP BY pizza_category
ORDER BY total_pizzas_sold DESC;

--7. Top 5 Pizzas by Revenue
SELECT TOP 5 pizza_name, SUM(total_price) AS total_revenue
FROM pizza_sales
GROUP BY pizza_name 
ORDER BY total_revenue DESC;

--8. Bottom 5 Pizzas by Revenue
SELECT TOP 5 pizza_name, CAST(SUM(total_price) AS DECIMAL(10,2)) AS total_revenue
FROM pizza_sales
GROUP BY pizza_name 
ORDER BY total_revenue ASC;

--9. Top 5 Pizzas by Quantity
SELECT TOP 5 pizza_name, SUM(quantity) AS total_pizza_sold 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY SUM(quantity) DESC;

--10. Bottom 5 Pizzas by Quantity
SELECT TOP 5 pizza_name, SUM(quantity) AS total_pizza_sold 
FROM pizza_sales
GROUP BY pizza_name
ORDER BY SUM(quantity) ASC;

--11. Top 5 Pizzas by Total Orders
SELECT TOP 5 pizza_name, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_orders DESC;

--12. Bottom 5 Pizzas by Total Orders
SELECT TOP 5 pizza_name, COUNT(DISTINCT order_id) AS total_orders
FROM pizza_sales
GROUP BY pizza_name
ORDER BY total_orders ASC;
